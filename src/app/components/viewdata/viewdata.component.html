<div class="fullcontainer">
    <div class="container">
      <div class="search-container">
        <!-- Search Inputs -->
        <mat-form-field appearance="outline" class="search-field mat-rounded">
          <mat-label>Search by Name</mat-label>
          <input matInput [(ngModel)]="searchName" placeholder="Name" />
        </mat-form-field>
  
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search by Email</mat-label>
          <input matInput [(ngModel)]="searchEmail" placeholder="Email" />
        </mat-form-field>
  
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search by Mobile</mat-label>
          <input matInput [(ngModel)]="searchMobile" placeholder="Mobile" />
        </mat-form-field>
  
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search by App ID</mat-label>
          <input matInput [(ngModel)]="searchAppId" placeholder="App ID" />
        </mat-form-field>
  
        <!-- Search and Reset Buttons -->
        <div class="search-buttons">
          <button mat-raised-button color="primary" (click)="onSearch()" class="search-button">
            <mat-icon>search</mat-icon> Search
          </button>
          <button mat-raised-button color="accent" (click)="showAll()" class="show-all-button">
            <mat-icon>restart_alt</mat-icon> Reset
          </button>
        </div>
            </div>
      <div class="datedown">
          <div class="date-container">
            <mat-form-field appearance="outline" class="date-field">
              <mat-label>Date Filter</mat-label>
              <mat-select [(value)]="selectedDateRange" (selectionChange)="applyDateFilter()">
               <mat-option value="all">All</mat-option> 
               <mat-option value="today">Today</mat-option>
                <mat-option value="thisWeek">This Week</mat-option>
                <mat-option value="thisMonth">This Month</mat-option>
                <mat-option value="custom">Custom Range</mat-option>
              </mat-select>
            </mat-form-field>
           
             <!-- If custom range is selected, show date pickers -->
             <div *ngIf="selectedDateRange === 'custom'" class="custom-date-range">
               <!-- Custom Start Date Picker -->
                <mat-form-field appearance="outline" class="date-field">
                  <mat-label>Start Date</mat-label>
                  <input matInput [(ngModel)]="customStartDate" placeholder="MM/DD/YYYY" [matDatepicker]="startPicker" (ngModelChange)="applyDateFilter()" />
                  <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
                  <mat-datepicker #startPicker></mat-datepicker>
                </mat-form-field>
                 
                <!-- Custom End Date Picker -->
                <mat-form-field appearance="outline" class="date-field">
                  <mat-label>End Date</mat-label>
                  <input matInput [(ngModel)]="customEndDate" placeholder="MM/DD/YYYY" [matDatepicker]="endPicker" (ngModelChange)="applyDateFilter()" />
                  <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
                  <mat-datepicker #endPicker></mat-datepicker>
                </mat-form-field>
             </div>
          </div>
          <div class="downloadbutton">
            <button mat-flat-button color="primary" class="downloadbutton" (click)="downloadCSV()">
              <mat-icon>download</mat-icon> Download
            </button>
          </div>
          
      </div>
      
      <!-- Download Dropdown -->
      
  
      <div class="table-wrapper">
        <mat-paginator
          [length]="totalRecords"
          [pageSize]="itemsPerPage"
          [pageSizeOptions]="[5, 10, 20, 50, 100, 1000]"
          [pageIndex]="currentPage - 1"
          (page)="onPageChange($event)">
        </mat-paginator>
    
        <!-- Table with Sort and Pagination -->
        <table mat-table [dataSource]="paginatedData" matSort class="mat-elevation-z8">
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
            <td mat-cell *matCellDef="let element"><span class="clickable-name" >
              {{ element.name || "N/A" }}
            </span> </td>
          </ng-container>
    
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Email </th>
            <td mat-cell *matCellDef="let element"> {{ element.email || "N/A" }} </td>
          </ng-container>
    
          <ng-container matColumnDef="mobile">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Mobile </th>
            <td mat-cell *matCellDef="let element"> {{ element.mobile || "N/A" }} </td>
          </ng-container>
    
          <ng-container matColumnDef="app_id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> App ID </th>
            <td mat-cell *matCellDef="let element"> {{ element.app_id || "N/A" }} </td>
          </ng-container>
    
          <ng-container matColumnDef="data.credit_score">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Credit Score </th>
            <td mat-cell *matCellDef="let element"> {{ element.data?.credit_score || "N/A" }} </td>
          </ng-container>
    
          <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Created At </th>
            <td mat-cell *matCellDef="let element"> {{ element.createdAt | date }} </td>
          </ng-container>
    
          <ng-container matColumnDef="updatedAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Updated At </th>
            <td mat-cell *matCellDef="let element"> 
              {{ element.updatedAt | date }} 
            </td>
          </ng-container>
          
          <!-- Conditional rendering for 'modifiedAt' when dataset is 'skoda' -->
          <ng-container matColumnDef="modifiedAt">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Modified At </th>
            <td mat-cell *matCellDef="let element">
              {{ element.modifiedAt | date }}
            </td>
          </ng-container>
    
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
       </div>
      </div>
    <div *ngIf="loading" class="overlay">
      <mat-spinner></mat-spinner>
    </div>
  </div>
  